package:
  name: soma

components:
  - soma-io
  - aims-free
  - aims-gpl
  - brainvisa-share
  - axon

# build:
#   number: 0
#   script: |
#     cd "$PIXI_PROJECT_ROOT"
#     pixi run bash << END
#     cd "$CASA_BUILD"
#     export BRAINVISA_INSTALL_PREFIX="$PREFIX"
#     for component in soma-io aims-free aims-gpl brainvisa-share axon; do
#       make install-\${component}
#       make install-\${component}-dev
#       make install-\${component}-usrdoc
#       make install-\${component}-devdoc
#     done
#     END

internal-dependencies:
  - soma-python

requirements:
  build:
    - ${{ compiler('cxx') }}
    - libstdcxx-devel_linux-64
    - cmake
    - make
    - libsigcpp <3
    - libblitz
    - boost-cpp
    - gfortran
    - graphviz
    - dcmtk
    - doxygen
    - pkgconfig
    - numpy
    - pyyaml
    - libminc
    - openjpeg

  run:
    - libblitz
    - boost-cpp
    - dcmtk
    - numpy
    - pyyaml
    - libminc
    - openjpeg
    - pywebp

  #run_constrained:
    #- pygltflib
    #- DracoPy

tests:
  - script: |
      python -m soma_forge test soma
      python -m soma_forge test aims
      python -m soma_forge test axon
